<view wx:if="{{showDraw}}">
    <form reportSubmit bindsubmit="collectFormId">
        <view class="detail-page">
            <view class="bonus">
                <view class="red-desc">
                    <view>送你微信电影红包，</view>
                    <view>快来领取吧~</view>
                </view>
                <view>
                    <button bindgetphonenumber="drawBonus" class="statusIcon" formType="submit" openType="getPhoneNumber"></button>
                    <icon class="flower"></icon>
                </view>
            </view>
        </view>
    </form>
</view>
<view class="show-result" wx:else>
    <view class="result-page" style="{{backgroundStyle}}" wx:if="{{resultDetail}}">
        <view class="draw-content">
            <view class="draw-success" wx:if="{{resultDetail.drawStatus==1}}">
                <view class="bonus-list" wx:for="{{resultDetail.bonusCouponList}}" wx:key="index">
                    <view class="bonus-item">
                        <view class="bonus-left" wx:if="{{item.valueType==1}}">
                            <text class="price">{{item.value}}</text>
                            <text class="unit">元</text>
                        </view>
                        <view class="bonus-left" wx:else>
                            <text class="unit">{{item.valueDesc}}</text>
                        </view>
                        <view class="bonus-right">
                            <text class="bonus-title ellipsis-wrap">{{item.title}}</text>
                            <text class="bonus-desc ellipsis">
                                <block wx:if="{{item.limitDesc&&item.limitDesc.length==2}}">{{item.limitDesc[0]}}</block>
                            </text>
                            <text class="bonus-time ellipsis">
                                <block wx:if="{{item.limitDesc&&item.limitDesc.length}}">{{item.limitDesc[item.limitDesc.length-1]}}</block>
                            </text>
                        </view>
                    </view>
                </view>
                <view class="city-bonus" wx:if="{{resultDetail.cityCouponList.length}}">
                    <view class="city-title">
                        <view class="city-title-left-line">
                            <text class="split-after" style="{{deviderColor}}">
                                <text></text>
                            </text>
                        </view>
                        <view class="city-title-text">{{resultDetail.couponCellList[1].cellTitle}}</view>
                        <view class="city-title-right-line">
                            <text class="split-after" style="{{deviderColor}}">
                                <text></text>
                            </text>
                        </view>
                    </view>
                    <view class="bonus-list" wx:for="{{resultDetail.cityCouponList}}" wx:key="index">
                        <view class="bonus-item">
                            <view class="bonus-left" wx:if="{{item.valueType==1}}">
                                <text class="price">{{item.value}}</text>
                                <text class="unit">元</text>
                            </view>
                            <view class="bonus-left" wx:else>
                                <text class="unit">{{item.valueDesc}}</text>
                            </view>
                            <view class="bonus-right">
                                <text class="bonus-title ellipsis-wrap">{{item.title}}</text>
                                <text class="bonus-desc ellipsis">
                                    <block wx:if="{{item.limitDesc&&item.limitDesc.length==2}}">{{item.limitDesc[0]}}</block>
                                </text>
                                <text class="bonus-time">
                                    <block wx:if="{{item.limitDesc&&item.limitDesc.length}}">{{item.limitDesc[item.limitDesc.length-1]}}</block>
                                </text>
                                <image class="bonus-flag" src="http://p1.meituan.net/mmdb/a4732617716a9b4670f8856c2321e2451230.png" wx:if="{{item.costTyp===2}}"></image>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
            <view class="draw-fail" wx:else>
                <view class="fail-status">
                    <text>{{resultDetail.drawMessage}}</text>
                </view>
                <view class="hot-movie-recommend">
                    <view class="title">
                        <view class="title-left" style="{{leftIcon}}"></view>
                        <view class="title-text" style="{{titleStyle}}">热门电影推荐</view>
                        <view class="title-right" style="{{rightIcon}}"></view>
                    </view>
                    <view class="movie-content">
                        <view class="hot-movie">
                            <view bindtap="goMovieDetail" class="movie-item" data-movieid="{{item.id}}" wx:for="{{hotMovielist}}">
                                <image class="movie-img" src="{{item.img}}"></image>
                                <text class="movie-name">{{item.nm}}</text>
                            </view>
                        </view>
                        <text bindtap="moreMovie" class="more-btn">去看看还有啥好电影～</text>
                    </view>
                </view>
            </view>
            <view class="desc-success" wx:if="{{resultDetail.drawStatus==1}}">
                <view class="explain">
                    <text class="line">红包已放至您的账户</text>
                    <text class="line">请在微信-我的-钱包-电影演出赛事小程序-我的优惠券中查看</text>
                </view>
                <view class="split">
                    <text class="split-after" style="{{deviderColor}}"></text>
                </view>
            </view>
            <view class="frinds-bonus" wx:if="{{resultDetail.bonusDrawList&&resultDetail.bonusDrawList.length>0}}">
                <view class="title">
                    <view class="title-left" style="{{leftIcon}}"></view>
                    <view class="title-text" style="{{titleStyle}}">看朋友们手气如何</view>
                    <view class="title-right" style="{{rightIcon}}"></view>
                </view>
                <view class="friends-list">
                    <view class="{{(index===resultDetail.bonusDrawList.length-1?'':'one-px-border-bottom ')+'friends-item'}}" wx:for="{{resultDetail.bonusDrawList}}" wx:key="avatarUrl">
                        <image class="friends-item-avatar" src="{{item.avatarUrl||'https://p1.meituan.net/movie/6b3fe8f3f33fd60748feac641671bb579696.png'}}"></image>
                        <view class="friends-item-info">
                            <text class="line-text ellipsis">{{item.nickName}}</text>
                            <text class="time">{{item.drawTime}}</text>
                        </view>
                        <view class="friends-item-num">
                            <text class="line-text">{{item.valueType===1?item.value+'元':item.valueDesc}}</text>
                            <view class="best" wx:if="{{item.tag}}">
                                <image class="crown" src="https://static.meituan.net/bs/MYFE/wxapp-wallet/file/images/bonus/crown.png"></image>
                                <text>手气最佳</text>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
            <view class="activity-desc">
                <view class="title">
                    <view class="title-left" style="{{leftIcon}}"></view>
                    <view class="title-text" style="{{titleStyle}}">活动细则</view>
                    <view class="title-right" style="{{rightIcon}}"></view>
                </view>
                <view class="desc-cpntent">
                    <text class="line">1.购票成功即可分享红包给小伙伴</text>
                    <text class="line">2.每次购票后分享最多限20人领取</text>
                    <text class="line">3.红包金额随机分配</text>
                    <text class="line">4.红包不能与其他电影活动同时共用</text>
                    <text class="line">5.红包仅限在线支付使用，且购票人手机号、领取红包时输入的手机号需为同一手机号</text>
                    <text class="line">6.每天最多可领取3个红包</text>
                    <text class="line">7.在参与活动过程中，如果出现作弊行为（如批量注册、恶意领取、虚假分享、虚假交易等），猫眼将自动取消您本次活动资格，并有权取消后续参与猫眼任意活动的权利，必要时追究法律责任</text>
                </view>
            </view>
            <view class="to-use-btn" wx:if="{{resultDetail.drawStatus==1}}">
                <button bindtap="gotoUse" class="red-btn" data-val_bid="b_d6m4vj2n">{{resultDetail.sharer?'去查看热映电影':'去使用'}}</button>
                <button class="red-btn" openType="share">分享给好友</button>
            </view>
        </view>
    </view>
</view>
<include src="/footer.wxml"></include>
